/*CASO 1*/
/*Permisos que se ejecutan en ADMIN*/
GRANT SELECT ANY TABLE, INSERT ANY TABLE, CREATE TABLE, UPDATE ANY TABLE
    , DROP ANY TABLE, CREATE SEQUENCE, CREATE INDEXTYPE 
TO MDY2131_P12_1;
/*Otra forma de hacerlo*/
GRANT CREATE PROCEDURE, CREATE TRIGGER, CREATE VIEW, CREATE MATERIALIZED VIEW 
TO MDY2131_P12_2;
/*CREACION SYNONIMOMS*/
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_APORTE_A_SBIF FOR MDY2131_P12_1.APORTE_A_SBIF;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_CLIENTE FOR MDY2131_P12_1.CLIENTE;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_COMUNA FOR MDY2131_P12_1.COMUNA;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_CREDITO FOR MDY2131_P12_1.CREDITO;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_CREDITO_CLIENTE FOR MDY2131_P12_1.CREDITO_CLIENTE;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_CUOTA_CREDITO_CLIENTE FOR MDY2131_P12_1.CUOTA_CREDITO_CLIENTE;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_FORMA_PAGO FOR MDY2131_P12_1.FORMA_PAGO;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_MOVIMIENTO FOR MDY2131_P12_1.MOVIMIENTO;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_PRODUCTO_INVERSION FOR MDY2131_P12_1.PRODUCTO_INVERSION;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_PRODUCTO_INVERSION_CLIENTE FOR MDY2131_P12_1.PRODUCTO_INVERSION_CLIENTE;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_PROFESION_OFICIO FOR MDY2131_P12_1.PROFESION_OFICIO;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_PROVINCIA FOR MDY2131_P12_1.PROVINCIA;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_REGION FOR MDY2131_P12_1.REGION;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_SUCURSAL FOR MDY2131_P12_1.SUCURSAL;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_TIPO_CONTRATO FOR MDY2131_P12_1.TIPO_CONTRATO;
CREATE OR REPLACE SYNONYM MDY2131_P12_2.SYN_TIPO_MOVIMIENTO FOR MDY2131_P12_1.TIPO_MOVIMIENTO;
/*CONSULTA TODAS LAS TABLAS DE P12_1*/
GRANT SELECT ON MDY2131_P12_1.APORTE_A_SBIF TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.COMUNA TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.CREDITO TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.CREDITO_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.CUOTA_CREDITO_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.FORMA_PAGO TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.MOVIMIENTO TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.PRODUCTO_INVERSION TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.PRODUCTO_INVERSION_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.PROFESION_OFICIO TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.PROVINCIA TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.REGION TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.SUCURSAL TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.TIPO_CONTRATO TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.TIPO_MOVIMIENTO TO MDY2131_P12_2 WITH GRANT OPTION;
/*Modificar*/
GRANT ALTER ON MDY2131_P12_1.CREDITO_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT ALTER ON MDY2131_P12_1.PRODUCTO_INVERSION_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT ALTER ON MDY2131_P12_1.CUOTA_CREDITO_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
/*Insertar*/
GRANT INSERT ON MDY2131_P12_1.CREDITO_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT INSERT ON MDY2131_P12_1.PRODUCTO_INVERSION_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT INSERT ON MDY2131_P12_1.CUOTA_CREDITO_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
/*Eliminar*/
GRANT DELETE ON MDY2131_P12_1.CREDITO_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT DELETE ON MDY2131_P12_1.PRODUCTO_INVERSION_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;
GRANT DELETE ON MDY2131_P12_1.CUOTA_CREDITO_CLIENTE TO MDY2131_P12_2 WITH GRANT OPTION;

/*Crear Vista y dar permisos de vista para mostrar en 12_3 y 12_4*/
DROP VIEW V_SYN_APORTE_A_SBIF;
CREATE OR REPLACE VIEW V_SYN_APORTE_A_SBIF
AS (SELECT * FROM MDY2131_P12_2.SYN_APORTE_A_SBIF);
/*3*/
GRANT SELECT ON MDY2131_P12_2.SYN_APORTE_A_SBIF TO MDY2131_P12_3;
SELECT * FROM MDY2131_P12_2.SYN_APORTE_A_SBIF;
/*4*/
GRANT SELECT ON MDY2131_P12_2.SYN_APORTE_A_SBIF TO MDY2131_P12_4;
SELECT * FROM MDY2131_P12_2.SYN_APORTE_A_SBIF;
/*Tablas de consulta*/
/*3*/
GRANT SELECT ON MDY2131_P12_1.COMUNA TO MDY2131_P12_3 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.PROVINCIA TO MDY2131_P12_3 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.REGION TO MDY2131_P12_3 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.TIPO_CONTRATO TO MDY2131_P12_3 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.TIPO_MOVIMIENTO TO MDY2131_P12_3 WITH GRANT OPTION;
CREATE OR REPLACE SYNONYM MDY2131_P12_3.SYN3_COMUNA FOR MDY2131_P12_1.COMUNA;
CREATE OR REPLACE SYNONYM MDY2131_P12_3.SYN3_PROVINCIA FOR MDY2131_P12_1.PROVINCIA;
CREATE OR REPLACE SYNONYM MDY2131_P12_3.SYN3_REGION FOR MDY2131_P12_1.REGION;
CREATE OR REPLACE SYNONYM MDY2131_P12_3.SYN3_SUCURSAL FOR MDY2131_P12_1.SUCURSAL;
CREATE OR REPLACE SYNONYM MDY2131_P12_3.SYN3_TIPO_CONTRATO FOR MDY2131_P12_1.TIPO_CONTRATO;
CREATE OR REPLACE SYNONYM MDY2131_P12_3.SYN3_TIPO_MOVIMIENTO FOR MDY2131_P12_1.TIPO_MOVIMIENTO;
/*4*/
GRANT SELECT ON MDY2131_P12_1.COMUNA TO MDY2131_P12_4 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.PROVINCIA TO MDY2131_P12_4 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.REGION TO MDY2131_P12_4 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.TIPO_CONTRATO TO MDY2131_P12_4 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P12_1.TIPO_MOVIMIENTO TO MDY2131_P12_4 WITH GRANT OPTION;
CREATE OR REPLACE SYNONYM MDY2131_P12_4.SYN4_COMUNA FOR MDY2131_P12_1.COMUNA;
CREATE OR REPLACE SYNONYM MDY2131_P12_4.SYN4_PROVINCIA FOR MDY2131_P12_1.PROVINCIA;
CREATE OR REPLACE SYNONYM MDY2131_P12_4.SYN4_REGION FOR MDY2131_P12_1.REGION;
CREATE OR REPLACE SYNONYM MDY2131_P12_4.SYN4_SUCURSAL FOR MDY2131_P12_1.SUCURSAL;
CREATE OR REPLACE SYNONYM MDY2131_P12_4.SYN4_TIPO_CONTRATO FOR MDY2131_P12_1.TIPO_CONTRATO;
CREATE OR REPLACE SYNONYM MDY2131_P12_4.SYN4_TIPO_MOVIMIENTO FOR MDY2131_P12_1.TIPO_MOVIMIENTO;

/*Caso 2*/
SELECT
TO_CHAR(numrun,'09G999G999')||'-'|| dvrun AS "Run Cliente",
INITCAP(pnombre||' '||snombre||' '||appaterno||' '||apmaterno) AS "Nombre Cliente",
TO_CHAR(fecha_nacimiento,'dd "de" Month') AS "Dia de Cumpleaños",
direccion AS " Direccion Cliente"
FROM cliente
WHERE EXTRACT(MONTH FROM fecha_nacimiento) = 09
ORDER BY "Dia de Cumpleaños"
;





/*Consultas*/
select * from cliente;